{"ast":null,"code":"\"use strict\";\n\nvar _slicedToArray = require(\"/mnt/c/Users/PC/Documents/PolkadotHelloWorld/PolkadotHelloWorld/Front-End-Project/substrate-node-template/substrate-front-end-template/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/slicedToArray\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports._eraSlashes = _eraSlashes;\nexports.eraSlashes = eraSlashes;\nexports._erasSlashes = _erasSlashes;\nexports.erasSlashes = erasSlashes;\n\nvar _rxjs = require(\"rxjs\");\n\nvar _operators = require(\"rxjs/operators\");\n\nvar _util = require(\"../util\"); // Copyright 2017-2020 @polkadot/api-derive authors & contributors\n// SPDX-License-Identifier: Apache-2.0\n\n\nvar CACHE_KEY = 'eraSlashes';\n\nfunction mapSlashes(era, noms, vals) {\n  var nominators = {};\n  var validators = {};\n  noms.forEach(function (_ref) {\n    var _ref2 = _slicedToArray(_ref, 2),\n        key = _ref2[0],\n        optBalance = _ref2[1];\n\n    nominators[key.args[1].toString()] = optBalance.unwrap();\n  });\n  vals.forEach(function (_ref3) {\n    var _ref4 = _slicedToArray(_ref3, 2),\n        key = _ref4[0],\n        optRes = _ref4[1];\n\n    validators[key.args[1].toString()] = optRes.unwrapOrDefault()[1];\n  });\n  return {\n    era: era,\n    nominators: nominators,\n    validators: validators\n  };\n}\n\nfunction _eraSlashes(instanceId, api) {\n  return (0, _util.memo)(instanceId, function (era, withActive) {\n    var cacheKey = \"\".concat(CACHE_KEY, \"-\").concat(era.toString());\n    var cached = withActive ? undefined : _util.deriveCache.get(cacheKey);\n    return cached ? (0, _rxjs.of)(cached) : (0, _rxjs.combineLatest)([api.query.staking.nominatorSlashInEra.entries(era), api.query.staking.validatorSlashInEra.entries(era)]).pipe((0, _operators.map)(function (_ref5) {\n      var _ref6 = _slicedToArray(_ref5, 2),\n          noms = _ref6[0],\n          vals = _ref6[1];\n\n      var value = mapSlashes(era, noms, vals);\n      !withActive && _util.deriveCache.set(cacheKey, value);\n      return value;\n    }));\n  });\n}\n\nfunction eraSlashes(instanceId, api) {\n  return (0, _util.memo)(instanceId, function (era) {\n    return api.derive.staking._eraSlashes(era, true);\n  });\n}\n\nfunction _erasSlashes(instanceId, api) {\n  return (0, _util.memo)(instanceId, function (eras, withActive) {\n    return eras.length ? (0, _rxjs.combineLatest)(eras.map(function (era) {\n      return api.derive.staking._eraSlashes(era, withActive);\n    })) : (0, _rxjs.of)([]);\n  });\n}\n\nfunction erasSlashes(instanceId, api) {\n  return (0, _util.memo)(instanceId, function () {\n    var withActive = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    return api.derive.staking.erasHistoric(withActive).pipe((0, _operators.switchMap)(function (eras) {\n      return api.derive.staking._erasSlashes(eras, withActive);\n    }));\n  });\n}","map":{"version":3,"sources":["/mnt/c/Users/PC/Documents/PolkadotHelloWorld/PolkadotHelloWorld/Front-End-Project/substrate-node-template/substrate-front-end-template/node_modules/@polkadot/api-derive/staking/erasSlashes.js"],"names":["Object","defineProperty","exports","value","_eraSlashes","eraSlashes","_erasSlashes","erasSlashes","_rxjs","require","_operators","_util","CACHE_KEY","mapSlashes","era","noms","vals","nominators","validators","forEach","key","optBalance","args","toString","unwrap","optRes","unwrapOrDefault","instanceId","api","memo","withActive","cacheKey","cached","undefined","deriveCache","get","of","combineLatest","query","staking","nominatorSlashInEra","entries","validatorSlashInEra","pipe","map","set","derive","eras","length","erasHistoric","switchMap"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports._eraSlashes = _eraSlashes;\nexports.eraSlashes = eraSlashes;\nexports._erasSlashes = _erasSlashes;\nexports.erasSlashes = erasSlashes;\n\nvar _rxjs = require(\"rxjs\");\n\nvar _operators = require(\"rxjs/operators\");\n\nvar _util = require(\"../util\");\n\n// Copyright 2017-2020 @polkadot/api-derive authors & contributors\n// SPDX-License-Identifier: Apache-2.0\nconst CACHE_KEY = 'eraSlashes';\n\nfunction mapSlashes(era, noms, vals) {\n  const nominators = {};\n  const validators = {};\n  noms.forEach(([key, optBalance]) => {\n    nominators[key.args[1].toString()] = optBalance.unwrap();\n  });\n  vals.forEach(([key, optRes]) => {\n    validators[key.args[1].toString()] = optRes.unwrapOrDefault()[1];\n  });\n  return {\n    era,\n    nominators,\n    validators\n  };\n}\n\nfunction _eraSlashes(instanceId, api) {\n  return (0, _util.memo)(instanceId, (era, withActive) => {\n    const cacheKey = `${CACHE_KEY}-${era.toString()}`;\n    const cached = withActive ? undefined : _util.deriveCache.get(cacheKey);\n    return cached ? (0, _rxjs.of)(cached) : (0, _rxjs.combineLatest)([api.query.staking.nominatorSlashInEra.entries(era), api.query.staking.validatorSlashInEra.entries(era)]).pipe((0, _operators.map)(([noms, vals]) => {\n      const value = mapSlashes(era, noms, vals);\n      !withActive && _util.deriveCache.set(cacheKey, value);\n      return value;\n    }));\n  });\n}\n\nfunction eraSlashes(instanceId, api) {\n  return (0, _util.memo)(instanceId, era => api.derive.staking._eraSlashes(era, true));\n}\n\nfunction _erasSlashes(instanceId, api) {\n  return (0, _util.memo)(instanceId, (eras, withActive) => eras.length ? (0, _rxjs.combineLatest)(eras.map(era => api.derive.staking._eraSlashes(era, withActive))) : (0, _rxjs.of)([]));\n}\n\nfunction erasSlashes(instanceId, api) {\n  return (0, _util.memo)(instanceId, (withActive = false) => api.derive.staking.erasHistoric(withActive).pipe((0, _operators.switchMap)(eras => api.derive.staking._erasSlashes(eras, withActive))));\n}"]},"metadata":{},"sourceType":"script"}