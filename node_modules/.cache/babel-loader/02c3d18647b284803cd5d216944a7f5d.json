{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"/mnt/c/Users/PC/Documents/PolkadotHelloWorld/PolkadotHelloWorld/Front-End-Project/substrate-node-template/substrate-front-end-template/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\");\n\nvar _asyncToGenerator = require(\"/mnt/c/Users/PC/Documents/PolkadotHelloWorld/PolkadotHelloWorld/Front-End-Project/substrate-node-template/substrate-front-end-template/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/asyncToGenerator\");\n\nvar _classCallCheck = require(\"/mnt/c/Users/PC/Documents/PolkadotHelloWorld/PolkadotHelloWorld/Front-End-Project/substrate-node-template/substrate-front-end-template/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/mnt/c/Users/PC/Documents/PolkadotHelloWorld/PolkadotHelloWorld/Front-End-Project/substrate-node-template/substrate-front-end-template/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass\");\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.LEDGER_DEFAULT_INDEX = exports.LEDGER_DEFAULT_CHANGE = exports.LEDGER_DEFAULT_ACCOUNT = void 0;\n\nvar _classPrivateFieldLooseBase2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classPrivateFieldLooseBase\"));\n\nvar _classPrivateFieldLooseKey2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classPrivateFieldLooseKey\"));\n\nvar _ledgerPolkadot = require(\"@zondax/ledger-polkadot\");\n\nvar _util = require(\"@polkadot/util\");\n\nvar _transportsNode = _interopRequireDefault(require(\"./transportsNode\"));\n\nvar _transportsWeb = _interopRequireDefault(require(\"./transportsWeb\")); // Copyright 2017-2020 @polkadot/ui-keyring authors & contributors\n// SPDX-License-Identifier: Apache-2.0\n\n\nvar LEDGER_DEFAULT_ACCOUNT = 0x80000000;\nexports.LEDGER_DEFAULT_ACCOUNT = LEDGER_DEFAULT_ACCOUNT;\nvar LEDGER_DEFAULT_CHANGE = 0x80000000;\nexports.LEDGER_DEFAULT_CHANGE = LEDGER_DEFAULT_CHANGE;\nvar LEDGER_DEFAULT_INDEX = 0x80000000;\nexports.LEDGER_DEFAULT_INDEX = LEDGER_DEFAULT_INDEX;\nvar SUCCESS_CODE = 0x9000;\n\nvar transports = _transportsNode.default.concat(_transportsWeb.default);\n\nvar APPS = {\n  kusama: _ledgerPolkadot.newKusamaApp,\n  polkadot: _ledgerPolkadot.newPolkadotApp\n};\n\nvar _app = (0, _classPrivateFieldLooseKey2.default)(\"app\");\n\nvar _chain = (0, _classPrivateFieldLooseKey2.default)(\"chain\");\n\nvar _transport = (0, _classPrivateFieldLooseKey2.default)(\"transport\"); // A very basic wrapper for a ledger app -\n//  - it connects automatically, creating an app as required\n//  - Promises return errors (instead of wrapper errors)\n\n\nvar Ledger = /*#__PURE__*/function () {\n  function Ledger(transport, chain) {\n    _classCallCheck(this, Ledger);\n\n    Object.defineProperty(this, _app, {\n      writable: true,\n      value: null\n    });\n    Object.defineProperty(this, _chain, {\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, _transport, {\n      writable: true,\n      value: void 0\n    }); // u2f is deprecated\n\n    (0, _util.assert)(['hid', 'webusb'].includes(transport), \"Unsupported transport \".concat(transport));\n    (0, _util.assert)(Object.keys(APPS).includes(chain), \"Unsupported chain \".concat(chain));\n    (0, _classPrivateFieldLooseBase2.default)(this, _chain)[_chain] = chain;\n    (0, _classPrivateFieldLooseBase2.default)(this, _transport)[_transport] = transport;\n  }\n\n  _createClass(Ledger, [{\n    key: \"_getApp\",\n    value: function () {\n      var _getApp2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _this = this;\n\n        var def, transport;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if ((0, _classPrivateFieldLooseBase2.default)(this, _app)[_app]) {\n                  _context.next = 7;\n                  break;\n                }\n\n                def = transports.find(function (_ref) {\n                  var type = _ref.type;\n                  return type === (0, _classPrivateFieldLooseBase2.default)(_this, _transport)[_transport];\n                });\n                (0, _util.assert)(def, \"Unable to find a transport for \".concat((0, _classPrivateFieldLooseBase2.default)(this, _transport)[_transport]));\n                _context.next = 5;\n                return def.create();\n\n              case 5:\n                transport = _context.sent;\n                (0, _classPrivateFieldLooseBase2.default)(this, _app)[_app] = APPS[(0, _classPrivateFieldLooseBase2.default)(this, _chain)[_chain]](transport);\n\n              case 7:\n                return _context.abrupt(\"return\", (0, _classPrivateFieldLooseBase2.default)(this, _app)[_app]);\n\n              case 8:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function _getApp() {\n        return _getApp2.apply(this, arguments);\n      }\n\n      return _getApp;\n    }()\n  }, {\n    key: \"_withApp\",\n    value: function () {\n      var _withApp2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(fn) {\n        var app;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                _context2.next = 3;\n                return this._getApp();\n\n              case 3:\n                app = _context2.sent;\n                _context2.next = 6;\n                return fn(app);\n\n              case 6:\n                return _context2.abrupt(\"return\", _context2.sent);\n\n              case 9:\n                _context2.prev = 9;\n                _context2.t0 = _context2[\"catch\"](0);\n                (0, _classPrivateFieldLooseBase2.default)(this, _app)[_app] = null;\n                throw _context2.t0;\n\n              case 13:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[0, 9]]);\n      }));\n\n      function _withApp(_x) {\n        return _withApp2.apply(this, arguments);\n      }\n\n      return _withApp;\n    }()\n  }, {\n    key: \"_wrapError\",\n    value: function () {\n      var _wrapError2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(promise) {\n        var result;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return promise;\n\n              case 2:\n                result = _context3.sent;\n                (0, _util.assert)(result.return_code === SUCCESS_CODE, result.error_message);\n                return _context3.abrupt(\"return\", result);\n\n              case 5:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      function _wrapError(_x2) {\n        return _wrapError2.apply(this, arguments);\n      }\n\n      return _wrapError;\n    }()\n  }, {\n    key: \"getAddress\",\n    value: function () {\n      var _getAddress = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n        var _this2 = this;\n\n        var confirm,\n            accountOffset,\n            addressOffset,\n            _ref2,\n            _ref2$account,\n            account,\n            _ref2$addressIndex,\n            addressIndex,\n            _ref2$change,\n            change,\n            _args5 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                confirm = _args5.length > 0 && _args5[0] !== undefined ? _args5[0] : false;\n                accountOffset = _args5.length > 1 && _args5[1] !== undefined ? _args5[1] : 0;\n                addressOffset = _args5.length > 2 && _args5[2] !== undefined ? _args5[2] : 0;\n                _ref2 = _args5.length > 3 && _args5[3] !== undefined ? _args5[3] : {}, _ref2$account = _ref2.account, account = _ref2$account === void 0 ? LEDGER_DEFAULT_ACCOUNT : _ref2$account, _ref2$addressIndex = _ref2.addressIndex, addressIndex = _ref2$addressIndex === void 0 ? LEDGER_DEFAULT_INDEX : _ref2$addressIndex, _ref2$change = _ref2.change, change = _ref2$change === void 0 ? LEDGER_DEFAULT_CHANGE : _ref2$change;\n                return _context5.abrupt(\"return\", this._withApp( /*#__PURE__*/function () {\n                  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(app) {\n                    var _yield$_this2$_wrapEr, address, pubKey;\n\n                    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n                      while (1) {\n                        switch (_context4.prev = _context4.next) {\n                          case 0:\n                            _context4.next = 2;\n                            return _this2._wrapError(app.getAddress(account + accountOffset, change, addressIndex + addressOffset, confirm));\n\n                          case 2:\n                            _yield$_this2$_wrapEr = _context4.sent;\n                            address = _yield$_this2$_wrapEr.address;\n                            pubKey = _yield$_this2$_wrapEr.pubKey;\n                            return _context4.abrupt(\"return\", {\n                              address: address,\n                              publicKey: \"0x\".concat(pubKey)\n                            });\n\n                          case 6:\n                          case \"end\":\n                            return _context4.stop();\n                        }\n                      }\n                    }, _callee4);\n                  }));\n\n                  return function (_x3) {\n                    return _ref3.apply(this, arguments);\n                  };\n                }()));\n\n              case 5:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function getAddress() {\n        return _getAddress.apply(this, arguments);\n      }\n\n      return getAddress;\n    }()\n  }, {\n    key: \"getVersion\",\n    value: function () {\n      var _getVersion = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7() {\n        var _this3 = this;\n\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                return _context7.abrupt(\"return\", this._withApp( /*#__PURE__*/function () {\n                  var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(app) {\n                    var _yield$_this3$_wrapEr, isLocked, major, minor, patch, isTestMode;\n\n                    return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n                      while (1) {\n                        switch (_context6.prev = _context6.next) {\n                          case 0:\n                            _context6.next = 2;\n                            return _this3._wrapError(app.getVersion());\n\n                          case 2:\n                            _yield$_this3$_wrapEr = _context6.sent;\n                            isLocked = _yield$_this3$_wrapEr.device_locked;\n                            major = _yield$_this3$_wrapEr.major;\n                            minor = _yield$_this3$_wrapEr.minor;\n                            patch = _yield$_this3$_wrapEr.patch;\n                            isTestMode = _yield$_this3$_wrapEr.test_mode;\n                            return _context6.abrupt(\"return\", {\n                              isLocked: isLocked,\n                              isTestMode: isTestMode,\n                              version: [major, minor, patch]\n                            });\n\n                          case 9:\n                          case \"end\":\n                            return _context6.stop();\n                        }\n                      }\n                    }, _callee6);\n                  }));\n\n                  return function (_x4) {\n                    return _ref4.apply(this, arguments);\n                  };\n                }()));\n\n              case 1:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function getVersion() {\n        return _getVersion.apply(this, arguments);\n      }\n\n      return getVersion;\n    }()\n  }, {\n    key: \"sign\",\n    value: function () {\n      var _sign = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9(message) {\n        var _this4 = this;\n\n        var accountOffset,\n            addressOffset,\n            _ref5,\n            _ref5$account,\n            account,\n            _ref5$addressIndex,\n            addressIndex,\n            _ref5$change,\n            change,\n            _args9 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                accountOffset = _args9.length > 1 && _args9[1] !== undefined ? _args9[1] : 0;\n                addressOffset = _args9.length > 2 && _args9[2] !== undefined ? _args9[2] : 0;\n                _ref5 = _args9.length > 3 && _args9[3] !== undefined ? _args9[3] : {}, _ref5$account = _ref5.account, account = _ref5$account === void 0 ? LEDGER_DEFAULT_ACCOUNT : _ref5$account, _ref5$addressIndex = _ref5.addressIndex, addressIndex = _ref5$addressIndex === void 0 ? LEDGER_DEFAULT_INDEX : _ref5$addressIndex, _ref5$change = _ref5.change, change = _ref5$change === void 0 ? LEDGER_DEFAULT_CHANGE : _ref5$change;\n                return _context9.abrupt(\"return\", this._withApp( /*#__PURE__*/function () {\n                  var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8(app) {\n                    var buffer, _yield$_this4$_wrapEr, signature;\n\n                    return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n                      while (1) {\n                        switch (_context8.prev = _context8.next) {\n                          case 0:\n                            buffer = (0, _util.u8aToBuffer)(message);\n                            _context8.next = 3;\n                            return _this4._wrapError(app.sign(account + accountOffset, change, addressIndex + addressOffset, buffer));\n\n                          case 3:\n                            _yield$_this4$_wrapEr = _context8.sent;\n                            signature = _yield$_this4$_wrapEr.signature;\n                            return _context8.abrupt(\"return\", {\n                              signature: (0, _util.u8aToHex)((0, _util.bufferToU8a)(signature))\n                            });\n\n                          case 6:\n                          case \"end\":\n                            return _context8.stop();\n                        }\n                      }\n                    }, _callee8);\n                  }));\n\n                  return function (_x6) {\n                    return _ref6.apply(this, arguments);\n                  };\n                }()));\n\n              case 4:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9, this);\n      }));\n\n      function sign(_x5) {\n        return _sign.apply(this, arguments);\n      }\n\n      return sign;\n    }()\n  }]);\n\n  return Ledger;\n}();\n\nexports.default = Ledger;","map":{"version":3,"sources":["/mnt/c/Users/PC/Documents/PolkadotHelloWorld/PolkadotHelloWorld/Front-End-Project/substrate-node-template/substrate-front-end-template/node_modules/@polkadot/ui-keyring/ledger/index.js"],"names":["_interopRequireDefault","require","Object","defineProperty","exports","value","default","LEDGER_DEFAULT_INDEX","LEDGER_DEFAULT_CHANGE","LEDGER_DEFAULT_ACCOUNT","_classPrivateFieldLooseBase2","_classPrivateFieldLooseKey2","_ledgerPolkadot","_util","_transportsNode","_transportsWeb","SUCCESS_CODE","transports","concat","APPS","kusama","newKusamaApp","polkadot","newPolkadotApp","_app","_chain","_transport","Ledger","transport","chain","writable","assert","includes","keys","def","find","type","create","fn","_getApp","app","promise","result","return_code","error_message","confirm","accountOffset","addressOffset","account","addressIndex","change","_withApp","_wrapError","getAddress","address","pubKey","publicKey","getVersion","isLocked","device_locked","major","minor","patch","isTestMode","test_mode","version","message","buffer","u8aToBuffer","sign","signature","u8aToHex","bufferToU8a"],"mappings":"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","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.LEDGER_DEFAULT_INDEX = exports.LEDGER_DEFAULT_CHANGE = exports.LEDGER_DEFAULT_ACCOUNT = void 0;\n\nvar _classPrivateFieldLooseBase2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classPrivateFieldLooseBase\"));\n\nvar _classPrivateFieldLooseKey2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classPrivateFieldLooseKey\"));\n\nvar _ledgerPolkadot = require(\"@zondax/ledger-polkadot\");\n\nvar _util = require(\"@polkadot/util\");\n\nvar _transportsNode = _interopRequireDefault(require(\"./transportsNode\"));\n\nvar _transportsWeb = _interopRequireDefault(require(\"./transportsWeb\"));\n\n// Copyright 2017-2020 @polkadot/ui-keyring authors & contributors\n// SPDX-License-Identifier: Apache-2.0\nconst LEDGER_DEFAULT_ACCOUNT = 0x80000000;\nexports.LEDGER_DEFAULT_ACCOUNT = LEDGER_DEFAULT_ACCOUNT;\nconst LEDGER_DEFAULT_CHANGE = 0x80000000;\nexports.LEDGER_DEFAULT_CHANGE = LEDGER_DEFAULT_CHANGE;\nconst LEDGER_DEFAULT_INDEX = 0x80000000;\nexports.LEDGER_DEFAULT_INDEX = LEDGER_DEFAULT_INDEX;\nconst SUCCESS_CODE = 0x9000;\n\nconst transports = _transportsNode.default.concat(_transportsWeb.default);\n\nconst APPS = {\n  kusama: _ledgerPolkadot.newKusamaApp,\n  polkadot: _ledgerPolkadot.newPolkadotApp\n};\n\nvar _app = (0, _classPrivateFieldLooseKey2.default)(\"app\");\n\nvar _chain = (0, _classPrivateFieldLooseKey2.default)(\"chain\");\n\nvar _transport = (0, _classPrivateFieldLooseKey2.default)(\"transport\");\n\n// A very basic wrapper for a ledger app -\n//  - it connects automatically, creating an app as required\n//  - Promises return errors (instead of wrapper errors)\nclass Ledger {\n  constructor(transport, chain) {\n    Object.defineProperty(this, _app, {\n      writable: true,\n      value: null\n    });\n    Object.defineProperty(this, _chain, {\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, _transport, {\n      writable: true,\n      value: void 0\n    });\n    // u2f is deprecated\n    (0, _util.assert)(['hid', 'webusb'].includes(transport), `Unsupported transport ${transport}`);\n    (0, _util.assert)(Object.keys(APPS).includes(chain), `Unsupported chain ${chain}`);\n    (0, _classPrivateFieldLooseBase2.default)(this, _chain)[_chain] = chain;\n    (0, _classPrivateFieldLooseBase2.default)(this, _transport)[_transport] = transport;\n  }\n\n  async _getApp() {\n    if (!(0, _classPrivateFieldLooseBase2.default)(this, _app)[_app]) {\n      const def = transports.find(({\n        type\n      }) => type === (0, _classPrivateFieldLooseBase2.default)(this, _transport)[_transport]);\n      (0, _util.assert)(def, `Unable to find a transport for ${(0, _classPrivateFieldLooseBase2.default)(this, _transport)[_transport]}`);\n      const transport = await def.create();\n      (0, _classPrivateFieldLooseBase2.default)(this, _app)[_app] = APPS[(0, _classPrivateFieldLooseBase2.default)(this, _chain)[_chain]](transport);\n    }\n\n    return (0, _classPrivateFieldLooseBase2.default)(this, _app)[_app];\n  }\n\n  async _withApp(fn) {\n    try {\n      const app = await this._getApp();\n      return await fn(app);\n    } catch (error) {\n      (0, _classPrivateFieldLooseBase2.default)(this, _app)[_app] = null;\n      throw error;\n    }\n  }\n\n  async _wrapError(promise) {\n    const result = await promise;\n    (0, _util.assert)(result.return_code === SUCCESS_CODE, result.error_message);\n    return result;\n  }\n\n  async getAddress(confirm = false, accountOffset = 0, addressOffset = 0, {\n    account = LEDGER_DEFAULT_ACCOUNT,\n    addressIndex = LEDGER_DEFAULT_INDEX,\n    change = LEDGER_DEFAULT_CHANGE\n  } = {}) {\n    return this._withApp(async app => {\n      const {\n        address,\n        pubKey\n      } = await this._wrapError(app.getAddress(account + accountOffset, change, addressIndex + addressOffset, confirm));\n      return {\n        address,\n        publicKey: `0x${pubKey}`\n      };\n    });\n  }\n\n  async getVersion() {\n    return this._withApp(async app => {\n      const {\n        device_locked: isLocked,\n        major,\n        minor,\n        patch,\n        test_mode: isTestMode\n      } = await this._wrapError(app.getVersion());\n      return {\n        isLocked,\n        isTestMode,\n        version: [major, minor, patch]\n      };\n    });\n  }\n\n  async sign(message, accountOffset = 0, addressOffset = 0, {\n    account = LEDGER_DEFAULT_ACCOUNT,\n    addressIndex = LEDGER_DEFAULT_INDEX,\n    change = LEDGER_DEFAULT_CHANGE\n  } = {}) {\n    return this._withApp(async app => {\n      const buffer = (0, _util.u8aToBuffer)(message);\n      const {\n        signature\n      } = await this._wrapError(app.sign(account + accountOffset, change, addressIndex + addressOffset, buffer));\n      return {\n        signature: (0, _util.u8aToHex)((0, _util.bufferToU8a)(signature))\n      };\n    });\n  }\n\n}\n\nexports.default = Ledger;"]},"metadata":{},"sourceType":"script"}