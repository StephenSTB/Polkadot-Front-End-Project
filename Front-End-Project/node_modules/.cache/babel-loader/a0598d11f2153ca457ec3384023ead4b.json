{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports._erasRewards = _erasRewards;\nexports.erasRewards = erasRewards;\n\nvar _rxjs = require(\"rxjs\");\n\nvar _operators = require(\"rxjs/operators\");\n\nvar _util = require(\"../util\"); // Copyright 2017-2020 @polkadot/api-derive authors & contributors\n// SPDX-License-Identifier: Apache-2.0\n\n\nvar CACHE_KEY = 'eraRewards';\n\nfunction mapRewards(eras, optRewards) {\n  return eras.map(function (era, index) {\n    return {\n      era: era,\n      eraReward: optRewards[index].unwrapOrDefault()\n    };\n  });\n}\n\nfunction _erasRewards(instanceId, api) {\n  return (0, _util.memo)(instanceId, function (eras, withActive) {\n    if (!eras.length) {\n      return (0, _rxjs.of)([]);\n    }\n\n    var cached = withActive ? [] : eras.map(function (era) {\n      return _util.deriveCache.get(\"\".concat(CACHE_KEY, \"-\").concat(era.toString()));\n    }).filter(function (value) {\n      return !!value;\n    });\n    var remaining = eras.filter(function (era) {\n      return !cached.some(function (cached) {\n        return era.eq(cached.era);\n      });\n    });\n\n    if (!remaining.length) {\n      return (0, _rxjs.of)(cached);\n    }\n\n    return api.query.staking.erasValidatorReward.multi(remaining).pipe((0, _operators.map)(function (optRewards) {\n      var query = mapRewards(remaining, optRewards);\n      !withActive && query.forEach(function (q) {\n        return _util.deriveCache.set(\"\".concat(CACHE_KEY, \"-\").concat(q.era.toString()), q);\n      });\n      return eras.map(function (era) {\n        return cached.find(function (cached) {\n          return era.eq(cached.era);\n        }) || query.find(function (query) {\n          return era.eq(query.era);\n        });\n      });\n    }));\n  });\n}\n\nfunction erasRewards(instanceId, api) {\n  return (0, _util.memo)(instanceId, function () {\n    var withActive = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    return api.derive.staking.erasHistoric(withActive).pipe((0, _operators.switchMap)(function (eras) {\n      return api.derive.staking._erasRewards(eras, withActive);\n    }));\n  });\n}","map":{"version":3,"sources":["/mnt/c/Users/PC/Documents/PolkadotHelloWorld/PolkadotHelloWorld/Front-End-Project1/substrate-node-template/substrate-front-end-template/node_modules/@polkadot/api-derive/staking/erasRewards.js"],"names":["Object","defineProperty","exports","value","_erasRewards","erasRewards","_rxjs","require","_operators","_util","CACHE_KEY","mapRewards","eras","optRewards","map","era","index","eraReward","unwrapOrDefault","instanceId","api","memo","withActive","length","of","cached","deriveCache","get","toString","filter","remaining","some","eq","query","staking","erasValidatorReward","multi","pipe","forEach","q","set","find","derive","erasHistoric","switchMap"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports._erasRewards = _erasRewards;\nexports.erasRewards = erasRewards;\n\nvar _rxjs = require(\"rxjs\");\n\nvar _operators = require(\"rxjs/operators\");\n\nvar _util = require(\"../util\");\n\n// Copyright 2017-2020 @polkadot/api-derive authors & contributors\n// SPDX-License-Identifier: Apache-2.0\nconst CACHE_KEY = 'eraRewards';\n\nfunction mapRewards(eras, optRewards) {\n  return eras.map((era, index) => ({\n    era,\n    eraReward: optRewards[index].unwrapOrDefault()\n  }));\n}\n\nfunction _erasRewards(instanceId, api) {\n  return (0, _util.memo)(instanceId, (eras, withActive) => {\n    if (!eras.length) {\n      return (0, _rxjs.of)([]);\n    }\n\n    const cached = withActive ? [] : eras.map(era => _util.deriveCache.get(`${CACHE_KEY}-${era.toString()}`)).filter(value => !!value);\n    const remaining = eras.filter(era => !cached.some(cached => era.eq(cached.era)));\n\n    if (!remaining.length) {\n      return (0, _rxjs.of)(cached);\n    }\n\n    return api.query.staking.erasValidatorReward.multi(remaining).pipe((0, _operators.map)(optRewards => {\n      const query = mapRewards(remaining, optRewards);\n      !withActive && query.forEach(q => _util.deriveCache.set(`${CACHE_KEY}-${q.era.toString()}`, q));\n      return eras.map(era => cached.find(cached => era.eq(cached.era)) || query.find(query => era.eq(query.era)));\n    }));\n  });\n}\n\nfunction erasRewards(instanceId, api) {\n  return (0, _util.memo)(instanceId, (withActive = false) => api.derive.staking.erasHistoric(withActive).pipe((0, _operators.switchMap)(eras => api.derive.staking._erasRewards(eras, withActive))));\n}"]},"metadata":{},"sourceType":"script"}